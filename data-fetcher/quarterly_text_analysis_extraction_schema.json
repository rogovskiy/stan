{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Quarterly Text Analysis Extraction Schema",
  "description": "Schema for extracted structured data from quarterly text analysis",
  "type": "object",
  "required": ["business_model", "initiatives", "changes", "headline_bullets", "quarterly_highlights", "overall_quarter_strength"],
  "properties": {
    "business_model": {
      "type": "object",
      "required": ["summary", "industry", "maturity_level"],
      "properties": {
        "summary": {
          "type": "string",
          "description": "Summary description of the company's business model"
        },
        "industry": {
          "type": "string",
          "description": "Industry sector or category"
        },
        "maturity_level": {
          "type": "string",
          "description": "Maturity level of the business",
          "enum": ["early", "growth", "mature", "declining"]
        }
      }
    },
    "initiatives": {
      "type": "array",
      "description": "List of strategic initiatives leading to growth",
      "items": {
        "type": "object",
        "required": ["title", "summary", "cumulative_progress", "last_quarter_progress", "status", "bullet_points"],
        "properties": {
          "title": {
            "type": "string",
            "description": "Title of the initiative"
          },
          "summary": {
            "type": "string",
            "description": "Summary description of the initiative"
          },
          "cumulative_progress": {
            "type": "string",
            "description": "Paragraph describing overall progress since the initiative's inception, including key milestones achieved and progress relative to original goals"
          },
          "last_quarter_progress": {
            "type": "string",
            "description": "Paragraph describing what was achieved or changed specifically in the current quarter"
          },
          "status": {
            "type": "string",
            "description": "Status of the initiative",
            "enum": ["new", "on track", "at risk"]
          },
          "bullet_points": {
            "type": "array",
            "description": "2-4 bullet points highlighting progress on this initiative for the current quarter",
            "minItems": 2,
            "maxItems": 4,
            "items": {
              "type": "string",
              "description": "A bullet point describing measurable progress on the initiative"
            }
          },
          "chart": {
            "type": "object",
            "description": "Chart specification for initiative strength visualization",
            "properties": {
              "type": {
                "type": "string",
                "description": "Chart type (should be 'bar' for initiatives)",
                "enum": ["bar", "stacked_bar", "line"]
              },
              "frequency": {
                "type": "string",
                "description": "Data frequency (should be 'quarterly' for initiatives)",
                "enum": ["annual", "quarterly"]
              },
              "metrics": {
                "type": "array",
                "description": "List of metrics to include in the chart (up to 5)",
                "maxItems": 5,
                "items": {
                  "type": "string",
                  "description": "Metric name from available metrics list"
                }
              }
            },
            "required": ["type", "frequency", "metrics"]
          }
        }
      }
    },
    "changes": {
      "type": "array",
      "description": "List of changes since last quarter",
      "items": {
        "type": "object",
        "required": ["sentence", "type"],
        "properties": {
          "sentence": {
            "type": "string",
            "description": "One sentence describing what has changed"
          },
          "type": {
            "type": "string",
            "description": "Type of change",
            "enum": ["good", "bad", "neutral"]
          }
        }
      }
    },
    "headline_bullets": {
      "type": "array",
      "description": "Up to 3 bullet points representing the most significant accomplishments, failures, or mixed/neutral results for the quarter, to be displayed on the quarter headline tile",
      "maxItems": 3,
      "items": {
        "type": "object",
        "required": ["text", "indicator"],
        "properties": {
          "text": {
            "type": "string",
            "description": "The bullet point text describing the accomplishment, failure, or mixed/neutral result"
          },
          "indicator": {
            "type": "string",
            "description": "Indicator showing whether this is an accomplishment (up), failure (down), or mixed/neutral (neutral - not strong enough in either direction)",
            "enum": ["up", "down", "neutral"]
          }
        }
      }
    },
    "quarterly_highlights": {
      "type": "object",
      "description": "Quarterly highlights section with text and optional charts",
      "properties": {
        "text": {
          "type": "string",
          "description": "Quarterly highlights section containing 1-2 paragraphs and bullet points summarizing the quarter's key developments in accessible language"
        },
        "charts": {
          "type": "array",
          "description": "Array of chart specifications to illustrate the highlights (up to 3 charts)",
          "maxItems": 3,
          "items": {
            "type": "object",
            "properties": {
              "type": {
                "type": "string",
                "description": "Chart type",
                "enum": ["bar", "stacked_bar", "line"]
              },
              "frequency": {
                "type": "string",
                "description": "Data frequency",
                "enum": ["annual", "quarterly"]
              },
              "metrics": {
                "type": "array",
                "description": "List of metrics to include in the chart (up to 5)",
                "maxItems": 5,
                "items": {
                  "type": "string",
                  "description": "Metric name from available metrics list"
                }
              }
            },
            "required": ["type", "frequency", "metrics"]
          }
        }
      },
      "required": ["text"]
    },
    "overall_quarter_strength": {
      "type": "string",
      "description": "Overall assessment of the quarter's performance strength",
      "enum": ["up", "down", "neutral"],
      "enumDescriptions": {
        "up": "Quarter shows strong positive performance, clear accomplishments, and material positive developments",
        "down": "Quarter shows negative performance, clear failures or setbacks, and material negative developments",
        "neutral": "Quarter shows mixed performance, ambiguous results, or not strong enough in either direction to be clearly positive or negative"
      }
    },
    "valuation": {
      "type": "object",
      "description": "Valuation information including methods, explanations, and supporting chart",
      "properties": {
        "methods": {
          "type": "array",
          "description": "List of valuation methods applicable to this company, ordered by preference (most preferred first)",
          "items": {
            "type": "object",
            "properties": {
              "method": {
                "type": "string",
                "enum": ["EPS", "FCF", "NAV"],
                "description": "Valuation method name"
              },
              "explanation": {
                "type": "string",
                "description": "Explanation of why this valuation method is appropriate for this company"
              },
              "preference_order": {
                "type": "integer",
                "description": "Order of preference (1 = most preferred, 2 = second most preferred, etc.)",
                "minimum": 1
              }
            },
            "required": ["method", "explanation", "preference_order"]
          }
        },
        "business_model_chart": {
          "type": "object",
          "description": "Chart specification for business model visualization that supports the valuation",
          "properties": {
            "type": {
              "type": "string",
              "description": "Chart type",
              "enum": ["bar", "stacked_bar", "line"]
            },
            "frequency": {
              "type": "string",
              "description": "Data frequency",
              "enum": ["annual", "quarterly"]
            },
            "metrics": {
              "type": "array",
              "description": "List of metrics to include in the chart (up to 5)",
              "maxItems": 5,
              "items": {
                "type": "string",
                "description": "Metric name from available metrics list"
              }
            }
          },
          "required": ["type", "frequency", "metrics"]
        }
      },
      "required": ["methods"]
    }
  },
  "additionalProperties": false
}

